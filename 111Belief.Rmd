---
title: "Belief"
author: '111'
date: "2025-12-12"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r clean and model}
library(openxlsx)
library(dplyr)

sheet_A <- read.xlsx("A.xlsx")
sheet_B <- read.xlsx("B.xlsx")
sheet_P <- read.xlsx("P.xlsx")
sheet_SE <- read.xlsx("SouthEast.xlsx")
sheet_H <- read.xlsx("conrr.xlsx")

colnames(sheet_A) <- c("age","region","physical","mental","smoker","belief","ses5","sex")
sheet_A$id <- NA
sheet_A <- sheet_A[, c("id","age","region","sex","smoker","physical","mental","belief","ses5")]

colnames(sheet_B) <- c("age","region","physical","mental","smoker","belief","ses5","sex")
sheet_B$id <- NA
sheet_B <- sheet_B[, c("id","age","region","sex","smoker","physical","mental","belief","ses5")]

colnames(sheet_P) <- c("age","region","physical","mental","smoker","belief","ses5","sex")
sheet_P$id <- NA
sheet_P <- sheet_P[, c("id","age","region","sex","smoker","physical","mental","belief","ses5")]

colnames(sheet_SE) <- c("age","physical","mental","smoker","belief","ses5","sex","region","id")
sheet_SE <- sheet_SE[, c("id","age","region","sex","smoker","physical","mental","belief","ses5")]

colnames(sheet_H) <- c("id","age","sex","smoker","physical","mental","belief")
sheet_H$region <- NA
sheet_H$ses5   <- NA
sheet_H <- sheet_H[, c("id","age","region","sex","smoker","physical","mental","belief","ses5")]


all_data <- rbind(sheet_A, sheet_B, sheet_P, sheet_SE, sheet_H)

names(all_data)
str(all_data)

# age
all_data$age_clean <- as.numeric(all_data$age)

# sex
all_data$sex_clean <- NA
all_data$sex_clean[all_data$sex == "M"] <- "M"
all_data$sex_clean[all_data$sex == "Male"] <- "M"
all_data$sex_clean[all_data$sex == "F"] <- "F"
all_data$sex_clean[all_data$sex == "Female"] <- "F"

# physical
all_data$physical_clean <- NA
all_data$physical_clean[all_data$physical == "Y"]   <- "Y"
all_data$physical_clean[all_data$physical == "Yes"] <- "Y"
all_data$physical_clean[all_data$physical == "N"]  <- "N"
all_data$physical_clean[all_data$physical == "No"] <- "N"

# mental
all_data$mental_clean <- NA
all_data$mental_clean[all_data$mental == "Y"]   <- "Y"
all_data$mental_clean[all_data$mental == "Yes"] <- "Y"
all_data$mental_clean[all_data$mental == "N"]  <- "N"
all_data$mental_clean[all_data$mental == "No"] <- "N"

# belief
all_data$belief_clean <- NA
all_data$belief_clean[all_data$belief == "Y"]   <- "Y"
all_data$belief_clean[all_data$belief == "Yes"] <- "Y"
all_data$belief_clean[all_data$belief == "N"]  <- "N"
all_data$belief_clean[all_data$belief == "No"] <- "N"

# smoke
all_data$smoker_clean <- NA
# Yes
all_data$smoker_clean[all_data$smoker == "Y"]       <- "Y"
all_data$smoker_clean[all_data$smoker == "Yes"]     <- "Y"
all_data$smoker_clean[all_data$smoker == "Current"] <- "Y"
# No
all_data$smoker_clean[all_data$smoker == "N"]  <- "N"
all_data$smoker_clean[all_data$smoker == "No"] <- "N"

# region, ses
all_data$region_clean <- all_data$region
all_data$ses5_clean   <- all_data$ses5

# validate
table(all_data$sex_clean, useNA = "ifany")
table(all_data$physical_clean, useNA = "ifany")
table(all_data$mental_clean, useNA = "ifany")
table(all_data$belief_clean, useNA = "ifany")
table(all_data$smoker_clean, useNA = "ifany")


# modelling 1--------------------------------
analysis_data <- all_data[, c(
  "belief_clean",
  "physical_clean",
  "mental_clean"
)]


analysis_data <- analysis_data[
  !is.na(analysis_data$belief_clean) &
    !is.na(analysis_data$physical_clean) &
    !is.na(analysis_data$mental_clean),
]


analysis_data$belief_clean   <- factor(analysis_data$belief_clean,
                                       levels = c("N", "Y"))

analysis_data$physical_clean <- factor(analysis_data$physical_clean,
                                       levels = c("N", "Y"))

analysis_data$mental_clean   <- factor(analysis_data$mental_clean,
                                       levels = c("N", "Y"))

model <- glm(
  belief_clean ~ physical_clean + mental_clean,
  data = analysis_data,
  family = binomial
)

summary(model)
```

A binomial regression model was fitted to assess whether on-going physical and mental health issues were associated with believing that oneâ€™s condition would worsen while waiting for treatment. There was no strong evidence that on-going physical health issues were associated with this belief (p = 0.25). Mental health issues were associated with lower odds of believing that the condition would worsen, although this association did not reach conventional levels of statistical significance (p = 0.075). Overall, the model provided limited evidence of an association between health issues and belief about worsening condition.

```{r model 2}
# modelling 2 ----------------------
analysis_data2 <- all_data[, c(
  "belief_clean",
  "physical_clean",
  "mental_clean",
  "smoker_clean",
  "age_clean",
  "sex_clean"
)]


analysis_data2 <- analysis_data2[
  !is.na(analysis_data2$belief_clean) &
    !is.na(analysis_data2$physical_clean) &
    !is.na(analysis_data2$mental_clean) &
    !is.na(analysis_data2$smoker_clean) &
    !is.na(analysis_data2$age_clean) &
    !is.na(analysis_data2$sex_clean),
]



analysis_data2$belief_clean   <- factor(analysis_data2$belief_clean,
                                       levels = c("N", "Y"))
analysis_data2$physical_clean <- factor(analysis_data2$physical_clean,
                                       levels = c("N", "Y"))
analysis_data2$mental_clean   <- factor(analysis_data2$mental_clean,
                                       levels = c("N", "Y"))
analysis_data2$smoker_clean   <- factor(analysis_data2$smoker_clean,
                                       levels = c("N", "Y"))
analysis_data2$sex_clean      <- factor(analysis_data2$sex_clean,
                                       levels = c("M", "F"))

summary(analysis_data2$age_clean)


model_full <- glm(
  belief_clean ~ physical_clean + mental_clean +
    smoker_clean + age_clean + sex_clean,
  data = analysis_data2,
  family = binomial
)

summary(model_full)

```
A binomial regression model was fitted to assess whether individuals with on-going physical or mental health issues believed their condition would worsen while waiting for treatment. After adjusting for smoking status, age and sex, there was no strong evidence of an association between belief and physical health issues (p = 0.52) or mental health issues (p = 0.39). No other covariates showed statistically significant associations.


```{r model 3}
# prevalence ----------------
## PH
table(all_data$physical_clean, useNA = "ifany")
prop.table(table(all_data$physical_clean, useNA = "no"))
mean(all_data$physical_clean == "Y", na.rm = TRUE)

#MH
table(all_data$mental_clean, useNA = "ifany")
mean(all_data$mental_clean == "Y", na.rm = TRUE)

all_data$any_health_issue <- NA
all_data$any_health_issue[
  all_data$physical_clean == "Y" | all_data$mental_clean == "Y"
] <- "Y"
all_data$any_health_issue[
  all_data$physical_clean == "N" & all_data$mental_clean == "N"
] <- "N"

table(all_data$any_health_issue, useNA = "ifany")
mean(all_data$any_health_issue == "Y", na.rm = TRUE)


# adjusted prevalence of any health issue ---

analysis_data3 <- all_data[, c(
  "any_health_issue",
  "age_clean",
  "sex_clean",
  "smoker_clean"
)]

analysis_data3 <- analysis_data3[
  !is.na(analysis_data3$any_health_issue) &
    !is.na(analysis_data3$age_clean) &
    !is.na(analysis_data3$sex_clean) &
    !is.na(analysis_data3$smoker_clean),
]

analysis_data3$any_health_issue <- factor(analysis_data3$any_health_issue,
                                         levels = c("N", "Y"))

analysis_data3$sex_clean    <- factor(analysis_data3$sex_clean,
                                     levels = c("M", "F"))

analysis_data3$smoker_clean <- factor(analysis_data3$smoker_clean,
                                     levels = c("N", "Y"))

model_prev <- glm(
  any_health_issue ~ age_clean + sex_clean + smoker_clean,
  data = analysis_data3,
  family = binomial
)

summary(model_prev)

```

The prevalence of on-going health issues was assessed using a binomial regression model. After adjusting for age, sex and smoking status, there was no strong evidence that any of these factors were associated with the prevalence of health issues in the cohort (all p > 0.05).
